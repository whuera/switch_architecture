<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>
        <%= title %>
    </title>
    <link rel="stylesheet" href="/css/index.css">
</head>

<body>

    <!-- GitHub Top Header -->
    <header class="github-header">
        <div class="header-left">
            <button class="menu-toggle">☰</button>
            <div class="repo-path" style="flex-direction: column; align-items: flex-start; gap: 0;">
                <div style="display: flex; align-items: center; gap: 4px;">
                    <a href="#" class="repo-owner">B24-eps and UPF</a>
                    <span class="separator">&</span>
                    <a href="#" class="repo-name">Consulting for Fintech</a>
                </div>
                <div style="font-size: 12px; font-weight: normal; opacity: 0.8;">Diseño de proyectos de Software,
                    arquitectura y
                    consultoria para Fintech</div>
            </div>
        </div>

        <div class="header-right">
            <button class="header-btn">+</button>
            <button class="header-btn">🔔</button>
            <div class="user-avatar">👤</div>
        </div>
    </header>

    <!-- GitHub Navigation Tabs -->
    <nav class="github-nav">
        <div class="nav-container">
            <a href="#" class="nav-item active">
                <span class="nav-icon">📝</span>
                Arquitectura Switch
            </a>
            <a href="#" class="nav-item" id="componentes-nav">
                <span class="nav-icon">🔧</span>
                Componentes
            </a>
            <a href="https://deepwiki.com/whuera/switch_architecture" class="nav-item" target="_blank"
                rel="noopener noreferrer">
                <span class="nav-icon">📚</span>
                Wiki
            </a>
            <a href="#" class="nav-item">
                <span class="nav-icon">🔒</span>
                Security
            </a>
            <a href="#" class="nav-item">
                <span class="nav-icon">📊</span>
                Insights
            </a>
            <a href="#" class="nav-item">
                <span class="nav-icon">⚙️</span>
                Settings
            </a>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="content-wrapper">
        <div class="github-container">

            <!-- Main Content Area -->
            <main class="main-area">

                <!-- Inicio Section (Default view) -->
                <div id="inicio-section" class="inicio-section">
                    <div class="inicio-card fade-in">
                        <h2>🏠 Inicio</h2>
                        <p>Bienvenido al sistema de arquitectura transaccional BASE24-eps.</p>

                        <div class="investment-card fade-in">
                            <div class="investment-image"
                                style="background-image: url('/images/arquitectura-diagram.png');"></div>
                            <div class="investment-content">
                                <div class="investment-tag">Arquitectura</div>
                                <div class="investment-text">
                                    Visualiza el flujo completo de la transacción
                                    <strong>Diagrama de Arquitectura Switch</strong>
                                </div>
                                <div class="chevron-right">›</div>
                            </div>
                        </div>

                        <div class="description-content" style="border-radius: 20px; padding: 24px; margin-top: 24px;">
                            <p class="intro-text">
                                Cuando una transacción financiera (ATM, POS, e-commerce o ISO8583) llega a BASE24-eps,
                                ésta sigue una serie de pasos ordenados y modulares que garantizan validación,
                                enrutamiento,
                                autorización y retorno seguro al canal originador.
                            </p>

                            <div class="info-grid" style="margin-top: 32px;">
                                <div class="info-item fade-in" id="validacion-btn">
                                    <div class="icon-wrapper">✅</div>
                                    <h3>Validación</h3>
                                </div>
                                <div class="info-item fade-in" id="enrutamiento-btn">
                                    <div class="icon-wrapper">🔄</div>
                                    <h3>Enrutamiento</h3>
                                </div>
                                <div class="info-item fade-in" id="autorizacion-btn">
                                    <div class="icon-wrapper">🛡️</div>
                                    <h3>Autorización</h3>
                                </div>
                                <div class="info-item fade-in" id="journal-btn">
                                    <div class="icon-wrapper">📝</div>
                                    <h3>Journal</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Arquitectura B24 eps Section (Hidden by default) -->
                <div id="arquitectura-section" class="arquitectura-section" style="display: none;">
                    <div class="arquitectura-card fade-in">
                        <h2>📐 Arquitectura B24 eps</h2>
                        <p>Diseño modular y escalable para el procesamiento de transacciones financieras.</p>

                        <div class="investment-card fade-in">
                            <div class="investment-image"
                                style="background-image: url('/images/arquitectura-diagram.png');"></div>
                            <div class="investment-content">
                                <div class="investment-tag">Arquitectura</div>
                                <div class="investment-text">
                                    Conoce el flujo detallado del procesamiento
                                    <strong>Diagrama de Flujo Transaccional</strong>
                                </div>
                                <div class="chevron-right">›</div>
                            </div>
                        </div>

                        <div class="arquitectura-content">
                            <div class="info-grid">
                                <div class="info-item fade-in">
                                    <div class="icon-wrapper">📐</div>
                                    <h3>Diseño</h3>
                                </div>
                                <div class="info-item fade-in">
                                    <div class="icon-wrapper">🔧</div>
                                    <h3>Componentes</h3>
                                </div>
                                <div class="info-item fade-in">
                                    <div class="icon-wrapper">📊</div>
                                    <h3>Estructura</h3>
                                </div>
                                <div class="info-item fade-in">
                                    <div class="icon-wrapper">🚀</div>
                                    <h3>Rendimiento</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Componentes B24 Section (Hidden by default) -->
                <div id="componentes-section" class="componentes-section" style="display: none;">
                    <div class="componentes-card fade-in">
                        <h2>🔧 Componentes B24</h2>
                        <p>Sistema de componentes reutilizables y módulos core.</p>

                        <div class="investment-card" id="core-modules-link" style="cursor: pointer;">
                            <div class="investment-image"
                                style="background-image: url('/images/core-modules-diagram.png');"></div>
                            <div class="investment-content">
                                <div class="investment-tag">Módulos Core</div>
                                <div class="investment-text">
                                    Explora los módulos principales del sistema
                                    <strong>AUTH, MDS, Journal & More</strong>
                                </div>
                                <div class="chevron-right">›</div>
                            </div>
                        </div>

                        <div class="componentes-content">
                            <div class="info-grid">
                                <div class="info-item fade-in">
                                    <div class="icon-wrapper">🧩</div>
                                    <h3>UI Components</h3>
                                </div>
                                <div class="info-item fade-in">
                                    <div class="icon-wrapper">🔌</div>
                                    <h3>API Integration</h3>
                                </div>
                                <div class="info-item fade-in">
                                    <div class="icon-wrapper">📚</div>
                                    <h3>Documentation</h3>
                                </div>
                                <div class="info-item fade-in">
                                    <div class="icon-wrapper">🔒</div>
                                    <h3>Security</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modulos B24 eps Section (Hidden by default) -->
                <div id="modulos-section" class="modulos-section" style="display: none;">
                    <div class="modulos-card fade-in">
                        <h2>📦 Core Modules</h2>
                        <p>Módulos principales del sistema</p>
                        <div class="modulos-content">
                            <img src="/images/core-modules-diagram.png" alt="Diagrama de Módulos Core"
                                class="core-modules-diagram">
                        </div>
                    </div>
                </div>

            </main>

        </div>
    </div>

    <!-- Footer -->
    <footer class="custom-footer">
        <div class="footer-top">
            <div class="footer-left-contact">
                <span class="contact-item">
                    <span class="icon">✉️</span> whuera@gmail.com
                </span>
                <span class="contact-item">
                    <span class="icon">🌐</span> +56 985689661
                    <span class="icon">🌐</span> +593 995331328
                </span>
            </div>


            <div class="footer-right-social">
                <div style="display: flex; flex-direction: column; align-items: center; gap: 8px;">
                    <a href="https://github.com/whuera" target="_blank" rel="noopener noreferrer" class="social-icon">
                        <svg height="20" width="20" viewBox="0 0 16 16" fill="currentColor" style="display: block;">
                            <path
                                d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
                            </path>
                        </svg>
                    </a>
                    <span style="font-size: 10px; color: rgba(255,255,255,0.8); letter-spacing: 0.5px;">GitHub
                        Repositorios</span>
                </div>
            </div>
        </div>

        <div class="footer-separator"></div>

        <div class="footer-bottom">
            <div class="footer-nav-links">
                <a href="#" class="contact-btn">SERVICE</a>
                <a href="https://whuera.github.io/index_fp.html" target="_blank" rel="noopener noreferrer"
                    class="contact-btn">PROJECTS</a>
                <a href="#" id="contact-btn-modal" class="contact-btn">CONTACT</a>
            </div>

            <div class="footer-copyright">
                &copy; <span id="year"></span> Switch Architecture.
            </div>
        </div>
    </footer>

    <!-- Modal for Validación -->
    <div id="validacion-modal" class="modal">
        <div class="modal-content acrylic-modal">
            <span class="close-modal">×</span>
            <div class="modal-header">
                <h2>✅ Motor de Validación</h2>
                <p>Integridad y seguridad de los datos transaccionales.</p>
            </div>
            <div class="modal-body">
                <div class="modal-section">
                    <h3>📄 Validación de Formato</h3>
                    <p>Asegura que el mensaje cumpla con los estándares:</p>
                    <ul>
                        <li>ISO8583 (Versiones 87, 93, 2003).</li>
                        <li>Estructuras XML / JSON para APIs.</li>
                        <li>Campos obligatorios y tipos de datos.</li>
                    </ul>
                    <div class="modal-tag">Fase 1: Sintaxis</div>
                </div>
                <div class="modal-section">
                    <h3>🔐 Validación de Seguridad</h3>
                    <p>Verificación de credenciales y criptografía:</p>
                    <ul>
                        <li>Validación de PIN (PIN Block).</li>
                        <li>Verificación de CVV/CVV2.</li>
                        <li>Criptogramas EMV y llaves dinámicas.</li>
                    </ul>
                    <div class="modal-tag">Fase 2: Seguridad</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Enrutamiento -->
    <div id="enrutamiento-modal" class="modal">
        <div class="modal-content acrylic-modal">
            <span class="close-modal">×</span>
            <div class="modal-header">
                <h2>🔄 Motor de Enrutamiento</h2>
                <p>Lógica de decisión y destino de transacciones.</p>
            </div>
            <div class="modal-body">
                <div class="modal-section">
                    <h3>📍 Source Routing (SRC_RTE)</h3>
                    <p>Evalúa el origen de la transacción basándose en:</p>
                    <ul>
                        <li>PAN / BIN del cliente.</li>
                        <li>Tipo de transacción (ATM, POS, E-commerce).</li>
                        <li>Canal de entrada y Institution ID.</li>
                    </ul>
                    <div class="modal-tag">Fase 1: Identificación</div>
                </div>
                <div class="modal-section">
                    <h3>🎯 Destination Routing (DST_RTE)</h3>
                    <p>Determina el destino final para la autorización:</p>
                    <ul>
                        <li><strong>On-Us:</strong> Autorización interna en BASE24-eps.</li>
                        <li><strong>External Host:</strong> Core bancario o autorizador externo.</li>
                        <li><strong>Interchange:</strong> Redes internacionales (Visa, Mastercard).</li>
                    </ul>
                    <div class="modal-tag">Fase 2: Destino</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Autorización -->
    <div id="autorizacion-modal" class="modal">
        <div class="modal-content acrylic-modal">
            <span class="close-modal">×</span>
            <div class="modal-header">
                <h2>🛡️ Motor de Autorización</h2>
                <p>Gestión de saldos y aprobación de transacciones.</p>
            </div>
            <div class="modal-body">
                <div class="modal-section">
                    <h3>🏦 Autorización On-Us</h3>
                    <p>Procesamiento interno para clientes del banco:</p>
                    <ul>
                        <li>Consulta de saldos en tiempo real.</li>
                        <li>Validación de límites y bloqueos.</li>
                        <li>Actualización de estados de cuenta.</li>
                    </ul>
                    <div class="modal-tag">Tipo: Interno</div>
                </div>
                <div class="modal-section">
                    <h3>🌐 Autorización Off-Us</h3>
                    <p>Comunicación con redes externas:</p>
                    <ul>
                        <li>Envío a Interchanges (Visa/Mastercard).</li>
                        <li>Manejo de Timeouts y Reintentos.</li>
                        <li>Traducción de códigos de respuesta.</li>
                    </ul>
                    <div class="modal-tag">Tipo: Externo</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Journal -->
    <div id="journal-modal" class="modal">
        <div class="modal-content acrylic-modal">
            <span class="close-modal">×</span>
            <div class="modal-header">
                <h2>📝 Sistema de Journaling</h2>
                <p>Registro histórico y auditoría de operaciones.</p>
            </div>
            <div class="modal-body">
                <div class="modal-section">
                    <h3>📊 Registro de Transacciones</h3>
                    <p>Auditoría completa de cada paso:</p>
                    <ul>
                        <li>Log de mensajes de entrada y salida.</li>
                        <li>Tiempos de respuesta y latencia.</li>
                        <li>Estado final de la transacción.</li>
                    </ul>
                    <div class="modal-tag">Función: Auditoría</div>
                </div>
                <div class="modal-section">
                    <h3>🔄 Recuperación y Reversas</h3>
                    <p>Manejo de consistencia de datos:</p>
                    <ul>
                        <li>Generación automática de reversas.</li>
                        <li>Conciliación de fin de día.</li>
                        <li>Recuperación ante fallos del sistema.</li>
                    </ul>
                    <div class="modal-tag">Función: Continuidad</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Contact -->
    <div id="contact-modal" class="modal">
        <div class="modal-content acrylic-modal">
            <span class="close-modal">×</span>
            <div class="modal-header">
                <h2>📩 Contacto</h2>
                <p>Déjanos tu mensaje y te contactaremos a la brevedad.</p>
            </div>
            <div class="modal-body">
                <form id="contact-form" class="premium-form">
                    <div class="form-group">
                        <label for="name">Nombre Completo</label>
                        <input type="text" id="name" name="name" placeholder="Tu nombre completo" required>
                    </div>
                    <div class="form-group">
                        <label for="documentId">Documento de Identidad</label>
                        <input type="text" id="documentId" name="documentId" placeholder="Ej: 161625522" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Correo</label>
                        <input type="email" id="email" name="email" placeholder="tu@email.com" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Teléfono</label>
                        <input type="tel" id="phone" name="phone" placeholder="+56 9..." required>
                    </div>
                    <div class="form-group">
                        <label for="comment">Comentario</label>
                        <textarea id="comment" name="comment" rows="4" placeholder="¿En qué podemos ayudarte?"
                            required></textarea>
                    </div>
                    <button type="submit" class="submit-btn" id="submit-contact">Enviar Mensaje</button>
                    <div id="form-response" class="form-response"></div>
                </form>
            </div>
        </div>
    </div>

    <script src="/js/index.js"></script>
    <script>
        // Toggle Sections
        document.addEventListener('DOMContentLoaded', function () {
            const arquitecturaNav = document.querySelector('.nav-item.active');
            const componentesNav = document.getElementById('componentes-nav');
            const arquitecturaSection = document.getElementById('arquitectura-section');
            const componentesSection = document.getElementById('componentes-section');
            const modulosSection = document.getElementById('modulos-section');
            const inicioSection = document.getElementById('inicio-section');

            function hideAllSections() {
                if (arquitecturaSection) arquitecturaSection.style.display = 'none';
                if (componentesSection) componentesSection.style.display = 'none';
                if (modulosSection) modulosSection.style.display = 'none';
                if (inicioSection) inicioSection.style.display = 'none';
            }

            function showInicioSection() {
                if (inicioSection) inicioSection.style.display = 'block';
            }

            // Toggle Arquitectura Section
            if (arquitecturaNav) {
                arquitecturaNav.addEventListener('click', function (e) {
                    e.preventDefault();

                    if (arquitecturaSection.style.display === 'none' || arquitecturaSection.style.display === '') {
                        hideAllSections();
                        arquitecturaSection.style.display = 'block';
                    } else {
                        hideAllSections();
                        showInicioSection();
                    }
                });
            }

            // Toggle Componentes Section
            if (componentesNav) {
                componentesNav.addEventListener('click', function (e) {
                    e.preventDefault();

                    if (componentesSection.style.display === 'none' || componentesSection.style.display === '') {
                        hideAllSections();
                        componentesSection.style.display = 'block';
                    } else {
                        hideAllSections();
                        showInicioSection();
                    }
                });
            }

            // Toggle Modulos Section from Core Modules link
            const coreModulesLink = document.getElementById('core-modules-link');

            if (coreModulesLink && modulosSection) {
                coreModulesLink.addEventListener('click', function (e) {
                    e.preventDefault();
                    hideAllSections();
                    modulosSection.style.display = 'block';
                });
            }

            // Modal Logic (Generic for all modals)
            const modalConfigs = [
                { btnId: 'validacion-btn', modalId: 'validacion-modal' },
                { btnId: 'enrutamiento-btn', modalId: 'enrutamiento-modal' },
                { btnId: 'autorizacion-btn', modalId: 'autorizacion-modal' },
                { btnId: 'journal-btn', modalId: 'journal-modal' },
                { btnId: 'contact-btn-modal', modalId: 'contact-modal' }
            ];

            modalConfigs.forEach(config => {
                const modal = document.getElementById(config.modalId);
                const btn = document.getElementById(config.btnId);
                if (btn && modal) {
                    const span = modal.querySelector('.close-modal');

                    btn.onclick = function () {
                        modal.style.display = "flex";
                    }

                    if (span) {
                        span.onclick = function () {
                            modal.style.display = "none";
                            // Reset form and response message when closing
                            if (config.modalId === 'contact-modal') {
                                document.getElementById('contact-form').reset();
                                document.getElementById('form-response').className = 'form-response';
                                document.getElementById('form-response').textContent = '';
                            }
                        }
                    }

                    window.addEventListener('click', function (event) {
                        if (event.target == modal) {
                            modal.style.display = "none";
                            if (config.modalId === 'contact-modal') {
                                document.getElementById('contact-form').reset();
                                document.getElementById('form-response').className = 'form-response';
                                document.getElementById('form-response').textContent = '';
                            }
                        }
                    });
                }
            });

            // Contact Form Submission
            const contactForm = document.getElementById('contact-form');
            const submitBtn = document.getElementById('submit-contact');
            const formResponse = document.getElementById('form-response');

            if (contactForm) {
                contactForm.addEventListener('submit', async function (e) {
                    e.preventDefault();

                    // Block button and show animation state
                    submitBtn.disabled = true;
                    submitBtn.classList.add('loading');
                    submitBtn.textContent = 'Enviando...';
                    formResponse.textContent = '';
                    formResponse.className = 'form-response';

                    const formData = new FormData(contactForm);
                    const fullName = formData.get('name');
                    const nameParts = fullName.trim().split(/\s+/);
                    const firstName = nameParts[0] || '';
                    const lastName = nameParts.slice(1).join(' ') || ' ';

                    const payload = {
                        firstName: firstName,
                        lastName: lastName,
                        email: formData.get('email'),
                        documentId: formData.get('documentId'),
                        phoneNumber: formData.get('phone'),
                        comment: formData.get('comment')
                    };

                    try {
                        const response = await fetch('https://azure-app-shopping-cart-reload-225fb76523b0.herokuapp.com/api/customer/create', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(payload)
                        });

                        if (response.ok) {
                            formResponse.textContent = '¡Mensaje enviado con éxito!';
                            formResponse.classList.add('success');
                            contactForm.reset();
                        } else {
                            throw new Error('Error en el servidor');
                        }
                    } catch (error) {
                        formResponse.textContent = 'Servicio no disponible por el momento';
                        formResponse.classList.add('error');
                    } finally {
                        submitBtn.disabled = false;
                        submitBtn.classList.remove('loading');
                        submitBtn.textContent = 'Enviar Mensaje';
                    }
                });
            }

            // Set current year in footer
            const yearSpan = document.getElementById('year');
            if (yearSpan) {
                yearSpan.textContent = new Date().getFullYear();
            }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/gh/gianmattus-programmer/Efecto-Fade-In/dist/fade-in.js"></script>
</body>

</html>